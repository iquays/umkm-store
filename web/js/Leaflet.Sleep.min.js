L.Map.mergeOptions({sleep:!0,sleepTime:750,wakeTime:750,sleepNote:!0,hoverToWake:!0,sleepOpacity:.7}),L.Map.Sleep=L.Handler.extend({addHooks:function(){this.sleepNote=L.DomUtil.create("p","sleep-note",this._map._container),this._sleepMap(),this._enterTimeout=null,this._exitTimeout=null;var a=this._map.getContainer().style;a.WebkitTransition+="opacity .5s",a.MozTransition+="opacity .5s";var b=this._map.options.wakeMessage||"Click "+(this._map.options.hoverToWake?"or Hover ":"")+"to Wake",c=this.sleepNote.style;this._map.options.sleepNote&&(this.sleepNote.appendChild(document.createTextNode(b)),c.maxWidth="150px",c.transitionDuration=".2s",c.zIndex=5e3,c.opacity=".6",c.margin="auto",c.textAlign="center",c.borderRadius="4px",c.top="50%",c.position="relative",c.padding="5px",c.border="solid 2px black",c.background="white")},removeHooks:function(){this._map.scrollWheelZoom.enabled()||this._map.scrollWheelZoom.enable(),L.DomUtil.setOpacity(this._map._container,1),L.DomUtil.setOpacity(this.sleepNote,0),this._removeSleepingListeners(),this._removeAwakeListeners()},_wakeMap:function(){this._stopWaiting(),this._map.scrollWheelZoom.enable(),L.DomUtil.setOpacity(this._map._container,1),this.sleepNote.style.opacity=0,this._addAwakeListeners()},_sleepMap:function(){this._stopWaiting(),this._map.scrollWheelZoom.disable(),L.DomUtil.setOpacity(this._map._container,this._map.options.sleepOpacity),this.sleepNote.style.opacity=.4,this._addSleepingListeners()},_wakePending:function(){if(this._map.once("mousedown",this._wakeMap,this),this._map.options.hoverToWake){var a=this;this._map.once("mouseout",this._sleepMap,this),a._enterTimeout=setTimeout(function(){a._map.off("mouseout",a._sleepMap,a),a._wakeMap()},a._map.options.wakeTime)}},_sleepPending:function(){var a=this;a._map.once("mouseover",a._wakeMap,a),a._exitTimeout=setTimeout(function(){a._map.off("mouseover",a._wakeMap,a),a._sleepMap()},a._map.options.sleepTime)},_addSleepingListeners:function(){this._map.once("mouseover",this._wakePending,this)},_addAwakeListeners:function(){this._map.once("mouseout",this._sleepPending,this)},_removeSleepingListeners:function(){this._map.options.hoverToWake&&this._map.off("mouseover",this._wakePending,this),this._map.off("mousedown",this._wakeMap,this)},_removeAwakeListeners:function(){this._map.off("mouseout",this._sleepPending,this)},_stopWaiting:function(){this._removeSleepingListeners(),this._removeAwakeListeners();var a=this;this._enterTimeout&&clearTimeout(a._enterTimeout),this._exitTimeout&&clearTimeout(a._exitTimeout),this._enterTimeout=null,this._exitTimeout=null}}),L.Map.addInitHook("addHandler","sleep",L.Map.Sleep);